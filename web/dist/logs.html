<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“‹ ç³»ç»Ÿæ—¥å¿— - NSFW-Go</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="static/css/design-system.css">
    <link rel="stylesheet" href="static/css/components.css">
    <link rel="stylesheet" href="static/css/tailwind-fixes.css">
    <style>
        /* é¡µé¢ç‰¹å®šæ ·å¼ */
        .logs-container {
            min-height: calc(100vh - 64px);
            padding: 2rem 1rem;
        }

        .log-entry {
            font-family: 'Consolas', 'Monaco', 'Lucida Console', monospace;
            font-size: 0.875rem;
            line-height: 1.5;
            border-left: 3px solid transparent;
            transition: all 0.2s;
        }

        .log-entry:hover {
            background: rgba(255, 255, 255, 0.02);
            border-left-color: var(--primary-light);
        }

        .log-level-info {
            border-left-color: #3b82f6;
        }

        .log-level-warn {
            border-left-color: #f59e0b;
        }

        .log-level-error {
            border-left-color: #ef4444;
        }

        .log-level-debug {
            border-left-color: #8b5cf6;
        }

        .log-timestamp {
            color: #6b7280;
            font-weight: 500;
        }

        .log-level {
            padding: 0.125rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            min-width: 60px;
            text-align: center;
        }

        .log-level.info {
            background: rgba(59, 130, 246, 0.2);
            color: #93c5fd;
        }

        .log-level.warn {
            background: rgba(245, 158, 11, 0.2);
            color: #fbbf24;
        }

        .log-level.error {
            background: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
        }

        .log-level.debug {
            background: rgba(139, 92, 246, 0.2);
            color: #c4b5fd;
        }

        .log-content {
            word-wrap: break-word;
            white-space: pre-wrap;
        }

        .filter-active {
            background: rgba(99, 102, 241, 0.2) !important;
            color: #818cf8 !important;
            border-color: rgba(99, 102, 241, 0.3) !important;
        }

        .auto-refresh-indicator {
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body class="min-h-screen overflow-x-hidden">
    <!-- é¡µé¢è¿›åº¦æ¡ -->
    <div id="pageProgress" class="page-progress">
        <div></div>
    </div>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <main class="page-container-table logs-container">
        <!-- é¡µé¢æ ‡é¢˜ -->
        <div class="flex-between mb-8">
            <div class="fade-in">
                <h1 class="text-2xl font-bold mb-2">
                    <span class="glow-text">ğŸ“‹ ç³»ç»Ÿæ—¥å¿—</span>
                </h1>
                <p class="text-secondary">å®æ—¶æŸ¥çœ‹ç³»ç»Ÿè¿è¡Œæ—¥å¿—å’Œé”™è¯¯ä¿¡æ¯</p>
            </div>

            <!-- æ“ä½œæŒ‰é’® -->
            <div class="flex gap-3">
                <button id="autoRefreshBtn" onclick="toggleAutoRefresh()" class="btn btn-success" title="è‡ªåŠ¨åˆ·æ–°">
                    <div class="auto-refresh-indicator"></div>
                    <span id="autoRefreshText">è‡ªåŠ¨åˆ·æ–°</span>
                </button>
                <button onclick="clearLogs()" class="btn btn-danger" title="æ¸…ç©ºæ—¥å¿—">
                    <i class="fas fa-trash"></i>
                    <span>æ¸…ç©º</span>
                </button>
                <button onclick="downloadLogs()" class="btn btn-primary" title="ä¸‹è½½æ—¥å¿—">
                    <i class="fas fa-download"></i>
                    <span>ä¸‹è½½</span>
                </button>
            </div>
        </div>

        <!-- è¿‡æ»¤å™¨å’Œæœç´¢ -->
        <div class="glass-card mb-6 fade-in" style="animation-delay: 0.1s;">
            <div class="flex flex-wrap gap-4 items-center">
                <!-- æ—¥å¿—çº§åˆ«è¿‡æ»¤ -->
                <div class="flex gap-2">
                    <span class="text-sm font-medium text-muted">çº§åˆ«:</span>
                    <button onclick="filterByLevel('all')" class="btn btn-sm btn-secondary filter-btn filter-active" data-level="all">
                        å…¨éƒ¨
                    </button>
                    <button onclick="filterByLevel('info')" class="btn btn-sm btn-secondary filter-btn" data-level="info">
                        INFO
                    </button>
                    <button onclick="filterByLevel('warn')" class="btn btn-sm btn-secondary filter-btn" data-level="warn">
                        WARN
                    </button>
                    <button onclick="filterByLevel('error')" class="btn btn-sm btn-secondary filter-btn" data-level="error">
                        ERROR
                    </button>
                    <button onclick="filterByLevel('debug')" class="btn btn-sm btn-secondary filter-btn" data-level="debug">
                        DEBUG
                    </button>
                </div>

                <!-- æ—¥å¿—åˆ†ç±»è¿‡æ»¤ -->
                <div class="flex gap-2">
                    <span class="text-sm font-medium text-muted">åˆ†ç±»:</span>
                    <button onclick="filterByCategory('all')" class="btn btn-sm btn-secondary category-btn filter-active" data-category="all">
                        å…¨éƒ¨
                    </button>
                    <button onclick="filterByCategory('system')" class="btn btn-sm btn-secondary category-btn" data-category="system">
                        ç³»ç»Ÿ
                    </button>
                    <button onclick="filterByCategory('crawler')" class="btn btn-sm btn-secondary category-btn" data-category="crawler">
                        çˆ¬è™«
                    </button>
                    <button onclick="filterByCategory('scanner')" class="btn btn-sm btn-secondary category-btn" data-category="scanner">
                        æ‰«æ
                    </button>
                    <button onclick="filterByCategory('torrent')" class="btn btn-sm btn-secondary category-btn" data-category="torrent">
                        ä¸‹è½½
                    </button>
                    <button onclick="filterByCategory('config')" class="btn btn-sm btn-secondary category-btn" data-category="config">
                        é…ç½®
                    </button>
                </div>

                <!-- æœç´¢æ¡† -->
                <div class="flex-1 min-w-64">
                    <div class="input-group">
                        <input
                            type="text"
                            id="searchInput"
                            placeholder="æœç´¢æ—¥å¿—å†…å®¹..."
                            class="input-field"
                            oninput="searchLogs()"
                        >
                        <button class="input-group-btn" onclick="searchLogs()">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ—¥å¿—ç»Ÿè®¡ -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 fade-in" style="animation-delay: 0.2s;" id="logStats">
            <!-- ç»Ÿè®¡å¡ç‰‡å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
        </div>

        <!-- æ—¥å¿—åˆ—è¡¨ -->
        <div class="glass-card fade-in" style="animation-delay: 0.3s;">
            <div class="card-header">
                <div class="flex-between">
                    <h3 class="card-title">
                        <i class="fas fa-list-alt text-primary-light"></i>
                        å®æ—¶æ—¥å¿—
                    </h3>
                    <div class="flex items-center gap-3">
                        <span class="text-sm text-muted" id="logCount">å…± 0 æ¡</span>
                        <button onclick="refreshLogs()" class="btn btn-sm btn-primary">
                            <i class="fas fa-sync-alt" id="refreshIcon"></i>
                            åˆ·æ–°
                        </button>
                    </div>
                </div>
            </div>

            <div class="card-body p-0">
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th class="col-time">æ—¶é—´</th>
                                <th class="col-level">çº§åˆ«</th>
                                <th class="col-module">æ¨¡å—</th>
                                <th class="col-action">æ“ä½œ</th>
                                <th class="col-message">æ¶ˆæ¯</th>
                            </tr>
                        </thead>
                        <tbody id="logsContainer">
                            <!-- æ—¥å¿—å†…å®¹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <script>
        // å…¨å±€å˜é‡
        let currentLogs = [];
        let filteredLogs = [];
        let currentStats = {};
        let currentLevelFilter = 'all';
        let currentCategoryFilter = 'all';
        let autoRefreshInterval = null;
        let isAutoRefresh = true;
        let isFirstLoad = true;

        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            initLogsPage();
            loadLogs();
            startAutoRefresh();
        });

        // åˆå§‹åŒ–æ—¥å¿—é¡µé¢
        function initLogsPage() {
            // è®¾ç½®é¡µé¢åŠ è½½è¿›åº¦
            const progress = document.querySelector('#pageProgress > div');
            if (progress) {
                progress.style.width = '50%';
                setTimeout(() => progress.style.width = '100%', 500);
                setTimeout(() => document.getElementById('pageProgress').style.display = 'none', 1000);
            }
        }

        // åŠ è½½æ—¥å¿—æ•°æ®
        async function loadLogs() {
            const container = document.getElementById('logsContainer');

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            if (!currentLogs.length) {
                container.innerHTML = components.createLoadingState('åŠ è½½æ—¥å¿—æ•°æ®...');
            }

            try {
                const response = await fetch('/api/v1/logs');

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();

                if (data.success && data.data) {
                    currentLogs = data.data;
                    // ä½¿ç”¨ä»APIè¿”å›çš„ç»Ÿè®¡ä¿¡æ¯
                    if (data.meta && data.meta.stats) {
                        currentStats = data.meta.stats;
                    }
                    applyFilters();
                    updateLogStats();
                    renderLogs();

                    if (!isFirstLoad) {
                        components.showNotification('æ—¥å¿—å·²åˆ·æ–°', 'success');
                    }
                    isFirstLoad = false;
                } else {
                    throw new Error(data.message || 'è¿”å›æ•°æ®æ ¼å¼é”™è¯¯');
                }
            } catch (error) {
                console.error('è·å–æ—¥å¿—å¤±è´¥:', error);

                // æ¨¡æ‹Ÿæ—¥å¿—æ•°æ®ç”¨äºæ¼”ç¤º
                currentLogs = generateMockLogs();
                applyFilters();
                updateLogStats();
                renderLogs();

                components.showNotification('æ— æ³•è¿æ¥åˆ°æ—¥å¿—æœåŠ¡ï¼Œæ­£åœ¨ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®', 'warning');
            }
        }

        // ç”Ÿæˆæ¨¡æ‹Ÿæ—¥å¿—æ•°æ®
        function generateMockLogs() {
            const levels = ['info', 'warn', 'error', 'debug'];
            const categories = ['system', 'crawler', 'scanner', 'torrent', 'config'];
            const mockLogs = [];

            const messages = {
                system: ['æœåŠ¡å™¨å¯åŠ¨å®Œæˆ', 'æ•°æ®åº“è¿æ¥æˆåŠŸ', 'APIæœåŠ¡å·²å°±ç»ª', 'å¥åº·æ£€æŸ¥é€šè¿‡'],
                crawler: ['å¼€å§‹çˆ¬å–JAVDbæ’è¡Œæ¦œ', 'çˆ¬å–å®Œæˆï¼Œå…±è·å–123æ¡æ•°æ®', 'é‡åˆ°åçˆ¬è™«é™åˆ¶ï¼Œç­‰å¾…é‡è¯•', 'æ’è¡Œæ¦œæ•°æ®å·²æ›´æ–°'],
                scanner: ['å¼€å§‹æ‰«ææœ¬åœ°åª’ä½“åº“', 'å‘ç°æ–°æ–‡ä»¶ï¼šSONE-123.mp4', 'æ‰«æå®Œæˆï¼Œå…±å¤„ç†456ä¸ªæ–‡ä»¶', 'è·³è¿‡é‡å¤æ–‡ä»¶'],
                torrent: ['æ·»åŠ ä¸‹è½½ä»»åŠ¡æˆåŠŸ', 'ç§å­æœç´¢å®Œæˆ', 'ä¸‹è½½è¿›åº¦ï¼š45%', 'qBittorrentè¿æ¥æµ‹è¯•æˆåŠŸ'],
                config: ['é…ç½®å·²æ›´æ–°', 'æ•°æ®åº“é…ç½®å¤‡ä»½å®Œæˆ', 'è¿æ¥æµ‹è¯•æˆåŠŸ', 'å·¥ä½œæ¨¡å¼å·²åˆ‡æ¢']
            };

            for (let i = 0; i < 50; i++) {
                const category = categories[Math.floor(Math.random() * categories.length)];
                const level = levels[Math.floor(Math.random() * levels.length)];
                const timestamp = new Date(Date.now() - Math.random() * 24 * 60 * 60 * 1000);
                const message = messages[category][Math.floor(Math.random() * messages[category].length)];

                mockLogs.push({
                    id: i + 1,
                    timestamp: timestamp.toISOString(),
                    level: level,
                    category: category,
                    message: message,
                    source: `${category}-service`
                });
            }

            return mockLogs.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
        }

        // åº”ç”¨è¿‡æ»¤å™¨
        function applyFilters() {
            filteredLogs = currentLogs.filter(log => {
                const levelMatch = currentLevelFilter === 'all' || log.level === currentLevelFilter;
                const categoryMatch = currentCategoryFilter === 'all' || log.category === currentCategoryFilter;

                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                const searchMatch = !searchTerm ||
                    log.message.toLowerCase().includes(searchTerm) ||
                    log.source.toLowerCase().includes(searchTerm);

                return levelMatch && categoryMatch && searchMatch;
            });
        }

        // æ›´æ–°æ—¥å¿—ç»Ÿè®¡
        function updateLogStats() {
            // ä¼˜å…ˆä½¿ç”¨ä»APIè¿”å›çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œå¦åˆ™ä»å½“å‰æ—¥å¿—è®¡ç®—
            const stats = currentStats.total ? currentStats : {
                total: currentLogs.length,
                info: currentLogs.filter(log => log.level === 'info').length,
                warn: currentLogs.filter(log => log.level === 'warn').length,
                error: currentLogs.filter(log => log.level === 'error').length,
                debug: currentLogs.filter(log => log.level === 'debug').length
            };

            const container = document.getElementById('logStats');
            container.innerHTML = `
                <div class="glass-card text-center">
                    <div class="stat-icon mx-auto mb-2" style="width: 48px; height: 48px;">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <div class="text-lg font-bold">${stats.total}</div>
                    <div class="text-sm text-muted">æ€»æ—¥å¿—</div>
                </div>
                <div class="glass-card text-center">
                    <div class="stat-icon mx-auto mb-2" style="width: 48px; height: 48px; background: rgba(59, 130, 246, 0.2);">
                        <i class="fas fa-info-circle"></i>
                    </div>
                    <div class="text-lg font-bold">${stats.info}</div>
                    <div class="text-sm text-muted">ä¿¡æ¯</div>
                </div>
                <div class="glass-card text-center">
                    <div class="stat-icon mx-auto mb-2" style="width: 48px; height: 48px; background: rgba(245, 158, 11, 0.2);">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="text-lg font-bold">${stats.warn}</div>
                    <div class="text-sm text-muted">è­¦å‘Š</div>
                </div>
                <div class="glass-card text-center">
                    <div class="stat-icon mx-auto mb-2" style="width: 48px; height: 48px; background: rgba(239, 68, 68, 0.2);">
                        <i class="fas fa-times-circle"></i>
                    </div>
                    <div class="text-lg font-bold">${stats.error}</div>
                    <div class="text-sm text-muted">é”™è¯¯</div>
                </div>
                <div class="glass-card text-center">
                    <div class="stat-icon mx-auto mb-2" style="width: 48px; height: 48px; background: rgba(139, 92, 246, 0.2);">
                        <i class="fas fa-bug"></i>
                    </div>
                    <div class="text-lg font-bold">${stats.debug || 0}</div>
                    <div class="text-sm text-muted">è°ƒè¯•</div>
                </div>
            `;
        }

        // æ¸²æŸ“æ—¥å¿—åˆ—è¡¨
        function renderLogs() {
            const container = document.getElementById('logsContainer');
            const logCountEl = document.getElementById('logCount');

            if (filteredLogs.length === 0) {
                container.innerHTML = `
                    <tr>
                        <td colspan="5" class="text-center py-8">
                            <div class="text-muted">
                                <i class="fas fa-search text-2xl mb-3"></i>
                                <p>æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æ—¥å¿—</p>
                                <button onclick="clearFilters()" class="btn btn-sm btn-primary mt-3">
                                    <i class="fas fa-times"></i>
                                    æ¸…é™¤è¿‡æ»¤å™¨
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
                logCountEl.textContent = 'å…± 0 æ¡';
                return;
            }

            const logsHTML = filteredLogs.map(log => {
                const timestamp = new Date(log.timestamp).toLocaleString('zh-CN', {
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });

                const levelClass = log.level === 'error' ? 'text-danger' :
                                 log.level === 'warn' ? 'text-warning' :
                                 log.level === 'info' ? 'text-success' : 'text-muted';

                return `
                    <tr class="log-level-${log.level}">
                        <td class="font-mono">${timestamp}</td>
                        <td>
                            <span class="badge badge-${log.level === 'error' ? 'danger' : log.level === 'warn' ? 'warning' : 'success'} ${levelClass}">
                                ${log.level.toUpperCase()}
                            </span>
                        </td>
                        <td class="text-muted">${log.category || '-'}</td>
                        <td class="text-muted">${log.action || '-'}</td>
                        <td class="break-words">${log.message}</td>
                    </tr>
                `;
            }).join('');

            container.innerHTML = logsHTML;
            logCountEl.textContent = `å…± ${filteredLogs.length} æ¡`;
        }

        // çº§åˆ«è¿‡æ»¤
        function filterByLevel(level) {
            currentLevelFilter = level;

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.toggle('filter-active', btn.dataset.level === level);
            });

            applyFilters();
            renderLogs();
        }

        // åˆ†ç±»è¿‡æ»¤
        function filterByCategory(category) {
            currentCategoryFilter = category;

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.toggle('filter-active', btn.dataset.category === category);
            });

            applyFilters();
            renderLogs();
        }

        // æœç´¢æ—¥å¿—
        function searchLogs() {
            applyFilters();
            renderLogs();
        }

        // æ¸…é™¤è¿‡æ»¤å™¨
        function clearFilters() {
            currentLevelFilter = 'all';
            currentCategoryFilter = 'all';
            document.getElementById('searchInput').value = '';

            // é‡ç½®æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.filter-btn, .category-btn').forEach(btn => {
                btn.classList.remove('filter-active');
            });
            document.querySelector('[data-level="all"]').classList.add('filter-active');
            document.querySelector('[data-category="all"]').classList.add('filter-active');

            applyFilters();
            renderLogs();
        }

        // åˆ·æ–°æ—¥å¿—
        async function refreshLogs() {
            const icon = document.getElementById('refreshIcon');
            icon.classList.add('fa-spin');

            try {
                await loadLogs();
                components.showNotification('æ—¥å¿—å·²åˆ·æ–°', 'success');
            } catch (error) {
                components.showNotification('åˆ·æ–°å¤±è´¥', 'error');
            } finally {
                icon.classList.remove('fa-spin');
            }
        }

        // åˆ‡æ¢è‡ªåŠ¨åˆ·æ–°
        function toggleAutoRefresh() {
            isAutoRefresh = !isAutoRefresh;
            const btn = document.getElementById('autoRefreshBtn');
            const text = document.getElementById('autoRefreshText');

            if (isAutoRefresh) {
                startAutoRefresh();
                btn.classList.remove('btn-secondary');
                btn.classList.add('btn-success');
                text.textContent = 'è‡ªåŠ¨åˆ·æ–°';
                components.showNotification('è‡ªåŠ¨åˆ·æ–°å·²å¼€å¯', 'success');
            } else {
                stopAutoRefresh();
                btn.classList.remove('btn-success');
                btn.classList.add('btn-secondary');
                text.textContent = 'æ‰‹åŠ¨æ¨¡å¼';
                components.showNotification('è‡ªåŠ¨åˆ·æ–°å·²å…³é—­', 'info');
            }
        }

        // å¼€å§‹è‡ªåŠ¨åˆ·æ–°
        function startAutoRefresh() {
            if (autoRefreshInterval) clearInterval(autoRefreshInterval);
            autoRefreshInterval = setInterval(() => {
                if (isAutoRefresh) {
                    loadLogs();
                }
            }, 5000); // æ¯5ç§’åˆ·æ–°ä¸€æ¬¡
        }

        // åœæ­¢è‡ªåŠ¨åˆ·æ–°
        function stopAutoRefresh() {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
                autoRefreshInterval = null;
            }
        }

        // æ¸…ç©ºæ—¥å¿—
        async function clearLogs() {
            if (!confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ—¥å¿—å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')) {
                return;
            }

            try {
                const response = await fetch('/api/v1/logs', {
                    method: 'DELETE'
                });

                if (response.ok) {
                    currentLogs = [];
                    applyFilters();
                    updateLogStats();
                    renderLogs();
                    components.showNotification('æ—¥å¿—å·²æ¸…ç©º', 'success');
                } else {
                    components.showNotification('æ¸…ç©ºå¤±è´¥', 'error');
                }
            } catch (error) {
                console.error('æ¸…ç©ºæ—¥å¿—å¤±è´¥:', error);
                components.showNotification('æ¸…ç©ºå¤±è´¥', 'error');
            }
        }

        // ä¸‹è½½æ—¥å¿—
        function downloadLogs() {
            const logText = filteredLogs.map(log => {
                const timestamp = new Date(log.timestamp).toLocaleString('zh-CN');
                return `[${timestamp}] [${log.level.toUpperCase()}] [${log.category}] ${log.message}`;
            }).join('\n');

            const blob = new Blob([logText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `nsfw-go-logs-${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            components.showNotification('æ—¥å¿—å·²ä¸‹è½½', 'success');
        }

        // é¡µé¢å¸è½½æ—¶æ¸…ç†
        window.addEventListener('beforeunload', () => {
            stopAutoRefresh();
        });
    </script>
    <script src="static/js/components.js"></script>
    <script src="static/js/modern-nav.js"></script>
</body>
</html>